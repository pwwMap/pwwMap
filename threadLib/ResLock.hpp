#ifndef __RES_LOCK_HPP__
#define __RES_LOCK_HPP__


#ifndef _WIN32
#include <stdio.h>
#include <pthread.h>
#include <errno.h>
#else
#include <windows.h>
#endif

// ------------------------------------------------------------------
/// @功能: 实现linux互斥锁与windows临界区常用操作的封装
// ------------------------------------------------------------------
class CResLock
{
public:
	// ------------------------------------------------------------------
	/// @功能: CResLock --- 初始化互斥锁或临界区对象
	// ------------------------------------------------------------------
	CResLock();

	// ------------------------------------------------------------------
	/// @功能: ~CResLock --- 析构销毁互斥锁或临界区
	// ------------------------------------------------------------------
	virtual ~CResLock();

	// ------------------------------------------------------------------
	/// @功能: lock --- 互斥锁加锁或进入临界区，封锁占用资源
	// ------------------------------------------------------------------
	void lock();

	// ------------------------------------------------------------------
	/// @功能:tryLock --- 互斥锁测试加锁或尝试进入临界区，非阻塞
	// ------------------------------------------------------------------
	int tryLock();

	// ------------------------------------------------------------------
	/// @功能: unLock --- 互斥锁解锁或离开临界区
	// ------------------------------------------------------------------
	void unLock();

private:
#ifdef _WIN32
	CRITICAL_SECTION m_mutex;
#else
	pthread_mutex_t m_mutex;
#endif
};


#endif
